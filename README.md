# XueXiTong_HealthCheckBeforeGoToSchool

在"学习通"的"入校前健康登记“操作健康打卡，进入提交记录搜索刚刚的提交记录判断打卡是否成功，然后截屏并发送email到自己手机邮箱.

# 下面分几个部分来介绍本程序

## **1. 这个程序在做什么**

### 1.1. 用电脑网页版代替手机APP学习通的"入校前健康登记"

### 1.2. 登录后添加体温数值，勾选健康、到校等选项，提交结果

### 1.3. 打开提交记录页，搜索当天日期以判断提交成功

### 1.4. 截图提交记录，并连同提交结果一起发送电子邮件到一个或多个手机邮箱

## **2. 功能怎么配置使用**

### 2.1. 将整个项目文件夹放在自己喜欢的位置

### 2.2. 双击setup.bat （windows 操作系统）文件，以配置计划任务。计划任务将每天早上6:30运行一次健康登记任务

### 2.3. 用记事本打卡配置模板personinf.ini

#### 2.3.1 按自己的实际情况修改自己的用户名: username=自己的学习通登录用户名

#### 2.3.2 按自己的实际情况修改自己的密码: password=自己的学习通登录密码

#### 2.3.3 按自己的实际情况修改自己发件人的邮箱地址：senderEmailAddr=自己的发件人邮箱

#### 2.3.4 按自己的实际情况修改自己发件人的邮箱的smtp： senderEmailAddr=自己的发件人邮箱smtp

#### 2.3.5 按自己的实际情况修改自己发件人邮箱授权码（一般终端软件不能用密码登录发送邮件）: authentication=邮箱授权码

#### 2.3.6 按自己的实际情况修改收件人邮箱邮箱地址，每个邮箱一行

        Receiver1='收件邮箱地址1'
        Receiver2='收件邮箱地址2'
        Receiver3='收件邮箱地址3'
        ......
        ReceiverN='收件邮箱地址N'

#### 2.3.7 保存

### 2.4. 安装Google Chrome 浏览器.下载地址： <https://www.google.cn/chrome/>

### 2.5. 添加Google Chrome浏览器对应版本的驱动chromedrive.exe

#### 2.5.1. 下载地址： <https://chromedriver.storage.googleapis.com/index.html>

#### 2.5.2. Windows操作系统的chromedriver.exe文件只有32位的，无论谷歌浏览器是32位还是64位

### 2.6. 谷歌浏览器驱动解压后放置的位置

#### 2.6.1. 一般放在系统环境变量所指的目录

#### 2.6.2. 我放在python安装目录的Script文件夹下： C:\Users\当前登录的用户\AppData\Local\Programs\Python\Python38\Scripts

## **3. 功能实现原理**

### 3.1. 通过批处理脚本添加windows计划任务

#### 3.1.1 以后每天就会自动在早上06:30运行健康登记程序并把结果发送到指定的电子邮箱

### 3.2. Python脚本读取excel中的异常日期

#### 3.2.1 因节假日调休，周末要上学

#### 3.2.2 因法定节假日，工作日休息

#### 3.3.3 寒暑假放假

### 4.1 网页操作

#### 4.1.1. 通过Selenium打卡谷歌浏览器，登录并打开"入校前健康登记"页面

#### 4.1.2. 通过Selenium添加体温值，默认在36.2和36.3之间随机选一个值

#### 4.1.3. 通过Selenium勾选健康及到校选项

#### 4.1.4. 通过Selenium提交登记

#### 4.1.5. 通过Selenium进入提交记录页面，搜索当天日期

##### 4.1.5.1 如果搜索到当天日期：提交成功

##### 4.1.5.2 如果不能搜索到当天日期：提交失败

##### 4.1.5.3 无论提交结果如何，都截图保存

### 5.1 发送邮件

#### 5.1.1 获取提交结果，在邮件内容中会以文字形式描述成功或失败

#### 5.1.2 上传之前保存的截图

#### 5.1.3 发送邮件到指定的接收邮箱
